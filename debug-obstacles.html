<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obstacle Debug Test</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; background: #333; color: white; }
        canvas { border: 2px solid #fff; display: block; margin: 20px auto; background: #87CEEB; }
        .debug { background: #222; padding: 20px; margin: 20px; border-radius: 5px; }
        button { padding: 10px 20px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>Obstacle Debug Test</h1>
    <div style="text-align: center;">
        <button onclick="startTest()">Start Test</button>
        <button onclick="addObstacle()">Add Obstacle</button>
        <button onclick="clearObstacles()">Clear Obstacles</button>
    </div>
    
    <canvas id="debugCanvas" width="800" height="400"></canvas>
    
    <div class="debug">
        <h3>Debug Info:</h3>
        <div id="debugInfo"></div>
    </div>

    <script>
        class ObstacleDebug {
            constructor() {
                this.canvas = document.getElementById('debugCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.obstacles = [];
                this.gameRunning = false;
                this.animationId = null;
                
                this.init();
            }
            
            init() {
                console.log('Initializing ObstacleDebug');
                this.addTestObstacles();
                this.updateDebugInfo();
            }
            
            addTestObstacles() {
                // Add some test obstacles
                this.obstacles = [
                    { x: 600, y: 280, width: 40, height: 80 },
                    { x: 900, y: 320, width: 80, height: 40 },
                    { x: 1200, y: 280, width: 40, height: 80 }
                ];
                console.log('Test obstacles added:', this.obstacles);
            }
            
            startTest() {
                this.gameRunning = true;
                this.gameLoop();
            }
            
            gameLoop() {
                if (!this.gameRunning) return;
                
                this.update();
                this.render();
                
                this.animationId = requestAnimationFrame(() => this.gameLoop());
            }
            
            update() {
                // Move obstacles left
                this.obstacles.forEach(obstacle => {
                    obstacle.x -= 2;
                });
                
                // Remove obstacles that are off screen
                this.obstacles = this.obstacles.filter(obstacle => obstacle.x + obstacle.width > -50);
                
                // Add new obstacles if needed
                if (this.obstacles.length < 3) {
                    this.addRandomObstacle();
                }
                
                this.updateDebugInfo();
            }
            
            addRandomObstacle() {
                const types = [
                    { width: 40, height: 80, y: 280 },
                    { width: 80, height: 40, y: 320 }
                ];
                
                const type = types[Math.floor(Math.random() * types.length)];
                const obstacle = {
                    x: this.canvas.width + 50,
                    y: type.y,
                    width: type.width,
                    height: type.height
                };
                
                this.obstacles.push(obstacle);
                console.log('New obstacle added:', obstacle);
            }
            
            render() {
                // Clear canvas
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Draw ground
                this.ctx.fillStyle = '#8B4513';
                this.ctx.fillRect(0, 360, this.canvas.width, 40);
                
                // Draw obstacles
                this.ctx.fillStyle = '#FF4444';
                this.obstacles.forEach((obstacle, index) => {
                    this.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                    
                    // Outline
                    this.ctx.strokeStyle = '#CC0000';
                    this.ctx.lineWidth = 3;
                    this.ctx.strokeRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                    
                    // Number
                    this.ctx.fillStyle = '#FFFFFF';
                    this.ctx.font = '16px Arial';
                    this.ctx.fillText(`${index + 1}`, obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2);
                });
                
                // Draw player
                this.ctx.fillStyle = '#4CAF50';
                this.ctx.fillRect(100, 300, 40, 60);
            }
            
            updateDebugInfo() {
                const debugDiv = document.getElementById('debugInfo');
                debugDiv.innerHTML = `
                    <p>Obstacles: ${this.obstacles.length}</p>
                    <p>Game Running: ${this.gameRunning}</p>
                    <p>Canvas Size: ${this.canvas.width} x ${this.canvas.height}</p>
                    <p>Obstacle Positions: ${this.obstacles.map(o => `(${Math.round(o.x)}, ${o.y})`).join(', ')}</p>
                `;
            }
        }
        
        let debugGame = new ObstacleDebug();
        
        function startTest() {
            debugGame.startTest();
        }
        
        function addObstacle() {
            debugGame.addRandomObstacle();
        }
        
        function clearObstacles() {
            debugGame.obstacles = [];
            debugGame.updateDebugInfo();
        }
    </script>
</body>
</html>
